asyncapi: 2.0.0
info:
  title: DarkflameServer WebSocket API
  version: 1.0.0
  description: API documentation for DarkflameServer WebSocket endpoints

servers:
  production:
    url: http://localhost:2005/ws
    protocol: http
    description: Production server

channels:
  player:
    subscribe:
      summary: Subscribe to player updates
      message:
        contentType: application/json
        payload:
          $ref: '#/components/schemas/PlayerUpdate'

  subscribe:
    publish:
      summary: Subscribe to an event
      message:
        contentType: application/json
        payload:
          $ref: '#/components/schemas/Subscription'

  unsubscribe:
    publish:
      summary: Unsubscribe from an event
      message:
        contentType: application/json
        payload:
          $ref: '#/components/schemas/Subscription'

components:
  schemas:
    PlayerUpdate:
      type: object
      properties:
        player_data:
          $ref: '#/components/schemas/Player'
        update_type:
          type: string
          example: "JOIN"

    Subscription:
      type: object
      required:
        - subscription
      properties:
        subscription:
          type: string
          example: "chat_local"

    Player:
      type: object
      properties:
        id:
          type: integer
          format: int64
          example: 1152921508901824000
        gm_level:
          type: integer
          format: uint8
          example: 0
        name:
          type: string
          example: thisisatestname
        muted:
          type: boolean
          example: false
        zone_id:
          $ref: '#/components/schemas/ZoneID'

    ZoneID:
      type: object
      properties:
        map_id:
          type: integer
          format: uint16
          example: 1200
        instance_id:
          type: integer
          format: uint16
          example: 2
        clone_id:
          type: integer
          format: uint32
          example: 0
